from bioCanon import __main__


def test_get_subtrees():
    memberships = {'Q': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                   'R': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
                   'O': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3],
                   'P': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 4],
                   'J': [1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 0, 0],
                   'I': [1, 1, 1, 1, 1, 1, 1, 1, 2, 0, 0, 0],
                   'H': [1, 1, 1, 1, 1, 1, 1, 2, 0, 0, 0, 0],
                   'G': [1, 1, 1, 1, 1, 1, 2, 0, 0, 0, 0, 0],
                   'S': [1, 1, 1, 1, 1, 2, 3, 0, 0, 0, 0, 0],
                   'F': [1, 1, 1, 1, 1, 2, 4, 0, 0, 0, 0, 0],
                   'B': [1, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0],
                   'C': [1, 1, 1, 2, 3, 0, 0, 0, 0, 0, 0, 0],
                   'T': [1, 1, 1, 2, 4, 3, 0, 0, 0, 0, 0, 0],
                   'U': [1, 1, 1, 2, 4, 4, 0, 0, 0, 0, 0, 0],
                   'M': [1, 1, 2, 3, 5, 5, 0, 0, 0, 0, 0, 0],
                   'N': [1, 1, 2, 3, 5, 6, 0, 0, 0, 0, 0, 0],
                   'K': [1, 1, 2, 3, 6, 7, 0, 0, 0, 0, 0, 0],
                   'L': [1, 1, 2, 3, 6, 8, 0, 0, 0, 0, 0, 0],
                   'E': [1, 1, 2, 4, 0, 0, 0, 0, 0, 0, 0, 0],
                   'D': [1, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                   'V': [1, 2, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                   'A': [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
    case = __main__.get_subtrees(memberships)
    compare = {21: [(['Q', 'R', 'O', 'P', 'J', 'I', 'H', 'G', 'S', 'F', 'B', 'C', 'T', 'U', 'M',
                      'N', 'K', 'L', 'E', 'D', 'V'], 0, 1)],
               1: [(['A'], 0, 2), (['A'], 1, 0), (['D'], 2, 3), (['V'], 2, 4), (['A'], 2, 0),
                   (['E'], 3, 4), (['B'], 4, 2), (['C'], 4, 3), (['T'], 5, 3), (['U'], 5, 4),
                   (['M'], 5, 5), (['N'], 5, 6), (['K'], 5, 7), (['L'], 5, 8), (['G'], 6, 2),
                   (['S'], 6, 3), (['F'], 6, 4), (['H'], 7, 2), (['I'], 8, 2), (['J'], 9, 2),
                   (['Q'], 11, 1), (['R'], 11, 2), (['O'], 11, 3), (['P'], 11, 4)],
               19: [(['Q', 'R', 'O', 'P', 'J', 'I', 'H', 'G', 'S', 'F', 'B', 'C', 'T', 'U',
                      'M', 'N', 'K', 'L', 'E'], 1, 1)],
               2: [(['D', 'V'], 1, 2), (['T', 'U'], 4, 4), (['M', 'N'], 4, 5), (['K', 'L'], 4, 6),
                   (['S', 'F'], 5, 2), (['Q', 'R'], 10, 1), (['O', 'P'], 10, 2)],
               14: [(['Q', 'R', 'O', 'P', 'J', 'I', 'H', 'G', 'S', 'F', 'B', 'C', 'T', 'U'], 2, 1)],
               5: [(['M', 'N', 'K', 'L', 'E'], 2, 2), (['Q', 'R', 'O', 'P', 'J'], 8, 1)],
               11: [(['Q', 'R', 'O', 'P', 'J', 'I', 'H', 'G', 'S', 'F', 'B'], 3, 1)],
               3: [(['C', 'T', 'U'], 3, 2), (['D', 'V', 'A'], 3, 0)],
               4: [(['M', 'N', 'K', 'L'], 3, 3), (['E', 'D', 'V', 'A'], 4, 0),
                   (['Q', 'R', 'O', 'P'], 9, 1)],
               10: [(['Q', 'R', 'O', 'P', 'J', 'I', 'H', 'G', 'S', 'F'], 4, 1)],
               8: [(['Q', 'R', 'O', 'P', 'J', 'I', 'H', 'G'], 5, 1)],
               6: [(['B', 'C', 'E', 'D', 'V', 'A'], 5, 0), (['Q', 'R', 'O', 'P', 'J', 'I'], 7, 1)],
               7: [(['Q', 'R', 'O', 'P', 'J', 'I', 'H'], 6, 1)],
               12: [(['B', 'C', 'T', 'U', 'M', 'N', 'K', 'L', 'E', 'D', 'V', 'A'], 6, 0)],
               15: [(['G', 'S', 'F', 'B', 'C', 'T', 'U', 'M', 'N', 'K', 'L', 'E', 'D', 'V', 'A'],
                     7, 0)],
               16: [(['H', 'G', 'S', 'F', 'B', 'C', 'T', 'U', 'M', 'N', 'K',
                      'L', 'E', 'D', 'V', 'A'], 8, 0)],
               17: [(['I', 'H', 'G', 'S', 'F', 'B', 'C', 'T', 'U', 'M', 'N', 'K',
                      'L', 'E', 'D', 'V', 'A'], 9, 0)],
               18: [(['J', 'I', 'H', 'G', 'S', 'F', 'B', 'C', 'T', 'U', 'M', 'N', 'K',
                      'L', 'E', 'D', 'V', 'A'], 10, 0),
                    (['J', 'I', 'H', 'G', 'S', 'F', 'B', 'C', 'T', 'U', 'M', 'N', 'K',
                      'L', 'E', 'D', 'V', 'A'], 11, 0)]}
    assert case == compare
